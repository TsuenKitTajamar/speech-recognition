<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Transcriptor con Historial</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 2rem;
    background: #f0f0f0;
    max-width: 600px;
    margin: auto;
    text-align: center;
  }
  #start {
    background: #007bff;
    color: white;
    border: none;
    padding: 1rem 2rem;
    font-size: 1.2rem;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  #start:hover:not(:disabled) {
    background: #0056b3;
  }
  #start:disabled {
    background: #999;
    cursor: not-allowed;
  }
  #status {
    margin-top: 1rem;
    font-weight: bold;
    color: #333;
  }
  #historial {
    margin-top: 2rem;
    background: white;
    border-radius: 10px;
    padding: 1rem;
    height: 300px;
    overflow-y: auto;
    text-align: left;
    box-shadow: 0 0 8px rgba(0,0,0,0.1);
  }
  .mensaje {
    background: #007bff;
    color: white;
    padding: 0.6rem 1rem;
    border-radius: 20px;
    margin-bottom: 10px;
    max-width: 80%;
    word-wrap: break-word;
  }
</style>
</head>
<body>

<button id="start">Empezar a escuchar</button>
<div id="status"></div>
<div id="historial"></div>

<script>
  const btn = document.getElementById('start');
  const status = document.getElementById('status');
  const historial = document.getElementById('historial');

  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  if (!SpeechRecognition) {
    btn.disabled = true;
    status.textContent = 'Lo siento, tu navegador no soporta reconocimiento de voz.';
  } else {
    const recognition = new SpeechRecognition();
    recognition.lang = 'es-ES';
    recognition.interimResults = false;

    btn.onclick = () => {
      recognition.start();
    };

    recognition.onstart = () => {
      status.textContent = 'Escuchando... üéôÔ∏è';
      btn.disabled = true;
      btn.style.cursor = 'wait';
    };

    recognition.onend = () => {
      status.textContent = 'Haz clic para empezar a escuchar';
      btn.disabled = false;
      btn.style.cursor = 'pointer';
    };

    recognition.onresult = e => {
      const texto = e.results[0][0].transcript;
      agregarMensaje(texto);
    };

    recognition.onerror = e => {
      agregarMensaje(`Error: ${e.error}`, true);
      status.textContent = '';
      btn.disabled = false;
      btn.style.cursor = 'pointer';
    };

    status.textContent = 'Haz clic para empezar a escuchar';
  }

  function agregarMensaje(texto, esError = false) {
    const div = document.createElement('div');
    div.classList.add('mensaje');
    if (esError) {
      div.style.background = '#dc3545'; // rojo para errores
    }
    div.textContent = texto;
    historial.appendChild(div);
    // Scroll autom√°tico abajo
    historial.scrollTop = historial.scrollHeight;
  }
</script>

</body>
</html>
